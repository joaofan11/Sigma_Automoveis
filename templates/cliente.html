<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rede Sigma de Automóveis</title>
    <link rel="stylesheet" href="static/css/cliente.css">
    <script>
        let editIndex = null; // Para armazenar o índice da linha editada

        // Função para abrir o modal para cadastro de cliente
        function abrirModalCadastro(index = null) {
            if (index !== null) {
                editIndex = index;
                preencherFormulario(index); // Preenche o formulário para edição
            } else {
                editIndex = null;
                limparFormulario(); // Limpa o formulário para novo cadastro
            }
            document.getElementById('modalCadastro').style.display = 'flex';
        }

        // Função para preencher o formulário com os dados de um cliente existente
        function preencherFormulario(index) {
            const row = document.querySelectorAll('table tbody tr')[index];
            document.getElementById('cpf').value = row.cells[0].textContent;
            document.getElementById('nome').value = row.cells[1].textContent;
            document.getElementById('rua').value = row.cells[2].textContent;
            document.getElementById('bairro').value = row.cells[3].textContent;
            document.getElementById('numero').value = row.cells[4].textContent;
            document.getElementById('cidade').value = row.cells[5].textContent;
            document.getElementById('estado').value = row.cells[6].textContent;
            document.getElementById('telefone').value = row.cells[7].textContent;
            document.getElementById('celular').value = row.cells[8].textContent;
            document.getElementById('renda').value = row.cells[9].textContent;
        }

        // Função para limpar o formulário
        function limparFormulario() {
            document.getElementById('cpf').value = '';
            document.getElementById('nome').value = '';
            document.getElementById('rua').value = '';
            document.getElementById('bairro').value = '';
            document.getElementById('numero').value = '';
            document.getElementById('cidade').value = '';
            document.getElementById('estado').value = '';
            document.getElementById('telefone').value = '';
            document.getElementById('celular').value = '';
            document.getElementById('renda').value = '';
        }

        // Função para excluir um cliente
        function excluirCliente(index) {
            if (confirm('Tem certeza que deseja excluir este cliente?')) {
                const tabela = document.querySelector('table tbody');
                tabela.deleteRow(index);
            }
        }

        // Função para cadastrar ou editar cliente
        function salvarCliente() {
            const cpf = document.getElementById('cpf').value;
            const nome = document.getElementById('nome').value;
            const rua = document.getElementById('rua').value;
            const bairro = document.getElementById('bairro').value;
            const numero = document.getElementById('numero').value;
            const cidade = document.getElementById('cidade').value;
            const estado = document.getElementById('estado').value;
            const telefone = document.getElementById('telefone').value;
            const celular = document.getElementById('celular').value;
            const renda = document.getElementById('renda').value;

            if (cpf && nome && rua && bairro && numero && cidade && estado && telefone && celular && renda) {
                const tabela = document.querySelector('table tbody');
                const dadosCliente = `
                    <td>${cpf}</td>
                    <td>${nome}</td>
                    <td>${rua}</td>
                    <td>${bairro}</td>
                    <td>${numero}</td>
                    <td>${cidade}</td>
                    <td>${estado}</td>
                    <td>${telefone}</td>
                    <td>${celular}</td>
                    <td>${renda}</td>
                    <td>
                        <button class="action-btn" onclick="abrirModalCadastro(${tabela.rows.length})">Editar</button>
                        <button class="action-btn delete" onclick="excluirCliente(${tabela.rows.length})">Excluir</button>
                    </td>
                `;

                if (editIndex !== null) {
                    // Editando a linha existente
                    const row = tabela.rows[editIndex];
                    row.innerHTML = dadosCliente; // Substitui a linha existente
                } else {
                    // Cadastrando um novo cliente
                    const novaLinha = document.createElement('tr');
                    novaLinha.innerHTML = dadosCliente;
                    tabela.appendChild(novaLinha);
                }
                fecharModalCadastro();
            } else {
                alert('Por favor, preencha todos os campos obrigatórios.');
            }
        }

        // Função para fechar o modal
        function fecharModalCadastro() {
            document.getElementById('modalCadastro').style.display = 'none';
        }
    </script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="logo">
                <img src="static/img/logo_sigma.png" alt="Logo">
            </div>
            <nav>
                <ul>
                    <li><a href="templates/veiculo.html">Controle de Veículos</a></li>
                    <li><a href="templates/operacao_venda.html">Controle de Vendas</a></li>
                    <li><a href="templates/operacao_compra.html">Controle de Compras</a></li>
                    <li><a href="templates/pedido.html">Controle de Pedidos</a></li>
                    <li><a href="templates/cliente.html">Controle de Clientes</a></li>
                    <li><a href="templates/vendendor.html">Controle de Vendedores</a></li>
                    <li><a href="templates/montadora.html">Controle de Montadoras</a></li>
                    <li><a href="templates/index.html">Sair</a></li>
                </ul>
            </nav>
        </aside>
        <main class="main-content">
            <header class="header">
                <input type="text" class="search-bar" placeholder="Buscar...">
                <button class="action-btn" onclick="abrirModalCadastro()">Cadastrar</button>
            </header>
            <section class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>CPF</th>
                            <th>Nome</th>
                            <th>Rua</th>
                            <th>Bairro</th>
                            <th>Número</th>
                            <th>Cidade</th>
                            <th>Estado</th>
                            <th>Telefone</th>
                            <th>Celular</th>
                            <th>Renda</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Linhas da tabela podem ser adicionadas aqui -->
                    </tbody>
                </table>
            </section>
        </main>
    </div>

    <!-- Modal para Cadastro de Cliente -->
    <div class="modal" id="modalCadastro">
        <div class="modal-content">
            <h2>Cadastrar Cliente</h2>
            <input type="text" id="cpf" placeholder="CPF" required>
            <input type="text" id="nome" placeholder="Nome" required>
            <input type="text" id="rua" placeholder="Rua" required>
            <input type="text" id="bairro" placeholder="Bairro" required>
            <input type="text" id="numero" placeholder="Número" required>
            <input type="text" id="cidade" placeholder="Cidade" required>
            <input type="text" id="estado" placeholder="Estado" required>
            <input type="text" id="telefone" placeholder="Telefone" required>
            <input type="text" id="celular" placeholder="Celular" required>
            <input type="number" id="renda" placeholder="Renda" required>
            <button onclick="salvarCliente()">Salvar</button>
            <button onclick="fecharModalCadastro()">Cancelar</button>
        </div>
    </div>
</body>
</html>
